# L1 Flow Stack

Система арбитража спот/перпетуал с умным управлением маржой.

## Настройка

### 1. Создание файла .env

Скопируйте `env.example` в `.env` и заполните необходимые значения:

```bash
cp env.example .env
```

### 2. Обязательные переменные окружения

#### Bybit API
- `BYBIT_API_KEY` - ваш API ключ Bybit
- `BYBIT_API_SECRET` - ваш API секрет Bybit  
- `BYBIT_ACCOUNT_TYPE` - тип аккаунта (обычно "unified")

#### Торговые параметры L1
- `L1_SYMBOLS` - символы для торговли через запятую (например: "BTC/USDT,ETH/USDT")
- `L1_FUNDING_THRESHOLD_8H` - минимальный порог фандинга за 8 часов (например: 0.001)
- `L1_MAX_ALLOC_PCT` - максимальный процент аллокации на пару (например: 80.0)
- `L1_PERP_LEVERAGE` - плечо для перпетуала (например: 3)
- `L1_MIN_FREE_BALANCE_USDT` - минимальный свободный баланс в USDT (например: 100.0)
- `L1_POLL_INTERVAL_SEC` - интервал опроса в секундах (например: 30)
- `L1_MAX_DAILY_DD_PCT` - максимальный дневной drawdown в процентах (например: 5.0)
- `L1_START_BASE_USDT` - стартовый базовый баланс в USDT (например: 1000.0)
- `L1_PNL_THRESHOLD_TO_L2` - порог PnL для перехода на L2 (например: 50.0)
- `L1_PNL_EXPORT_SHARE` - доля экспорта PnL (например: 0.3)

#### Telegram
- `TG_BOT_TOKEN` - токен вашего Telegram бота
- `TG_CHAT_ID` - ID чата для уведомлений

### 3. Запуск

```bash
docker-compose up -d
```

### 4. Проверка логов

```bash
docker-compose logs -f l1_bot
```

## Структура проекта

- `l1_bot/` - основной торговый бот
- `flow_manager/` - менеджер потоков
- `shared/` - общие файлы (база данных, логи)
- `logs/` - логи системы

## Важные замечания

1. **Безопасность**: Никогда не коммитьте файл `.env` в git
2. **API ключи**: Убедитесь, что у ваших API ключей есть права на торговлю
3. **Тестирование**: Сначала протестируйте на тестовом аккаунте
4. **Мониторинг**: Регулярно проверяйте логи и состояние системы
